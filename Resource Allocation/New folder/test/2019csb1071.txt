Name: Aneeket Mangal
Roll: 2019CSB1071

1. 
select distinct c1.courseid, (
    select count(distinct (semester, year))  
    from teaches t2 
    where t2.course_id = c1.courseid) 
from course c1, teaches t1 
where t1.course_id = c1.courseid;

2.
select i1.insid, i1.dept_name,inscount.count
from instructor i1, (
    select t2.ins_id,  
    count(distinct (course_id, section_id, semester, year)) 
    from teaches t2, course c2 
    where t2.course_id = c2.courseid
    group by t2.ins_id)
    as inscount(insid, count) 
    where inscount.insid = i1.insid and inscount.count = (
        select max(count) from (
            select t3.ins_id,  
            count(distinct (course_id, section_id, semester, year)) 
            from teaches t3, course c3 
            where t3.course_id = c3.courseid
            group by t3.ins_id) 
            as inscount2(insid, count)
        );

3.
select distinct t1.course_id, t1.semester, t1.year
from takes t1
where not exists (
    select *
    from student s2, takes t2
    where 
    (t1.course_id, t1.semester, t1.year) = (t2.course_id, t2.semester, t2.year)
    and s2.studentid = t2.studentid
    and s2.dept_name <> 'CSE'
);

4. 
select distinct i1.insid, i1.dept_name 
from instructor i1
where exists(
    select * 
    from teaches, course 
    where teaches.ins_id = i1.insid 
    and teaches.course_id = course.courseid 
    and i1.dept_name = course.dept_name);

5.
select distinct t1.ins_id, (
    select max(ct.count)
    from (
        select tee2.course_id, tee2.semester, tee2.year, count(*)
        from teaches tee2, takes t2
        where tee2.ins_id = t1.ins_id
        and (t1.course_id, t1.semester, t1.year) = (t2.course_id, t2.semester, t2.year)
        group by tee2.course_id, tee2.semester, tee2.year
        
    ) as ct(id, sem, year, count)
) from teaches t1;
